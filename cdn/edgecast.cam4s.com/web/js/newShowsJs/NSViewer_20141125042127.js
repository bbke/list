var flashObj=flashObj?flashObj:{};var NewShowState={notAvailable:"viewer_notAvailable",guest:"viewer_guest",noPrivateShow:"viewer_noPrivateShow",notRequestingPrivateShow:"viewer_notRequestingPrivateShow",requestingPrivateShow:"viewer_requestingPrivateShow",inPrivateShow:"viewer_inPrivateShow",accesDenied:"viewer_accessDenied",requestingSpy:"viewer_requestingSpy",inSpy:"viewer_inSpy",requestExpired:"viewer_requestExpired",pendingPrivateShow:"pendingPrivateShow",requestGroupShow:"viewer_requestGroupShow",inGroupShow:"viewer_inGroupShow",goalReached:"viewer_goalReached",goalReachedTicketPurchased:"viewer_goalReachedTicketPurchased",sellingTicketsTicketPurchased:"viewer_sellingTicketsTicketPurchased",guestInGroupShow:"viewer_guestGS",accessDeniedGS:"viewer_accessDeniedGS",accessDeniedInBonusTime:"viewer_accessDeniedBT",inBonusTime:"viewer_inBonusTime",groupShowPaused:"viewer_groupShowPaused",inCam2Cam:"viewer_inPrivateShowCam2Cam",requestingCam2Cam:"viewer_requestingCam2Cam",cam2cam:{disabled:"noCam2Cam",requestEnabled:"enableRequest",requestSended:"requestSent",playerWindowClosed:"closeRequestAlert",inCam2Cam:"inCam2Cam"},currentCam2CamState:"undefined"};var NewShowReceiver={onCam2CamUpdate:function(c){function b(e){return CAM2CAM_TITLE+" - "+e;}var a=$j("#Cam2CamButton");switch(c){case NewShowState.cam2cam.disabled:a.hide();a.attr("class","Cam2CamButton-Active");break;case NewShowState.cam2cam.requestEnabled:a.show();var d=b(StateDescription.request);a.text(d);a.attr("class","Cam2CamButton-Active");a.attr("onclick","NewShowSender.requestCam2Cam(); GoogleTrackNewShow.requestCam2Cam()");break;case NewShowState.cam2cam.requestSended:a.show();var d=b(StateDescription.pending);a.text(d);a.attr("class","Cam2CamButton-Inactive");a.removeAttr("onclick");break;case NewShowState.cam2cam.playerWindowClosed:var d=b(StateDescription.request);a.text(d);a.attr("class","Cam2CamButton-Active");a.attr("onclick","NewShowSender.requestCam2Cam(); GoogleTrackNewShow.requestCam2Cam()");a.show();break;case NewShowState.cam2cam.inCam2Cam:var d=b(StateDescription.active);a.text(d);a.show();a.attr("class","Cam2CamButton-Inactive");a.removeAttr("onclick");break;}NewShowState.currentCam2CamState=c;NewShow.fixLang();},receiptData:{},receiptMode:{inPS:"rPS",inGS:"rGS",inSS:"rSS"},setMiddleButtonText:function(a){$j("#mainPSButton").html(a);var b=$j("#requestPrivateShow").text().length;if(b>26&&b<34){$j("#requestPrivateShow").css("font-size","10px");}else{if(b>34){$j("#requestPrivateShow").css("font-size","9px");}else{$j("#requestPrivateShow").css("font-size","12px");}}},addStickyMessage:function(b){try{console.log("adding sticky from flash::::");ncTip.addStickyMessage(b);}catch(a){console.log(a);}},tipSent:function(){ncTip.enableSendTipInput();},updateBillingPrivateShow:function(h,f,c,e){var g=parseInt(h/3600)%24;var b=parseInt(h/60)%60;var a=h%60;var d=Math.round(b);$j(".timestatus").html("<span id='timestatuspan'><em></em>"+NewShow.LeadingZero(g)+":"+NewShow.LeadingZero(d)+":"+NewShow.LeadingZero(a)+"</span>");writeCookie("under");},showReceipt:function(d,e){if(d){NewShowReceiver.receiptData=jQuery.parseJSON(d);}$j("#pm.miscFeat").fadeIn();$j("#privateFromReceipt").fadeIn();$j("#receiptFeatWrap .featList input[type=button]").fadeIn();console.log("SHOW RECEIPT MODE:  "+e,d);console.log(NewShowReceiver.receiptData);$j("#cam2camDuration").hide();var c=NewShowReceiver.receiptData;$j("#receiptWrap").height(370);if(!+c.cost||parseInt(c.cost)<0){Cam4Logs.print("Flash sent illegal token ammount: "+c.cost);c.cost=0;}$j("#privateFromReceipt").val("");switch(e){case NewShowReceiver.receiptMode.inPS:$j("#headerReceiptViewer").text(PRIVATE_SHOW_RECEIPT_TITLE);$j("#showCost").show();$j("#showCost").css("font-weight","bold");$j("#ticketCost").hide();$j("#tipsSent").hide();$j("#showCost .valueSpan").text(c.cost+nstiplang.tokens);if(c.timeInCam2Cam){$j("#cam2camDuration").show();$j("#cam2camDuration .valueSpan").text(Utils.secondsToTime(c.timeInCam2Cam).inline());}var b=RATE_PRIVATE_SHOW.replace("%0","<em>");b=b.replace("%1",c.broadcasterName);b=b.replace("%2","</em>");$j("#rateNSDivTxt").html(b);break;case NewShowReceiver.receiptMode.inGS:$j("#headerReceiptViewer").text(GROUP_SHOW_RECEIPT_TITLE);$j("#showCost").hide();$j("#ticketCost").show();$j("#tipsSent").show();$j("#ticketCost").css("font-weight","bold");$j("#tipsSent").css("font-weight","bold");$j("#ticketCost .valueSpan").text(c.ticketCost+nstiplang.tokens);$j("#tipsSent .valueSpan").text(c.tipsSent+nstiplang.tokens);var b=RATE_GROUP_SHOW.replace("%0","<em>");b=b.replace("%1",c.broadcasterName);b=b.replace("%2","</em>");$j("#rateNSDivTxt").html(b);c.cost=c.ticketCost+c.tipsSent;$j("#receiptWrap").height(400);break;case NewShowReceiver.receiptMode.inSS:$j("#headerReceiptViewer").text(SPY_SHOW_RECEIPT_TITLE);$j("#showCost").show();$j("#showCost").css("font-weight","bold");$j("#ticketCost").hide();$j("#tipsSent").hide();var b=RATE_SPY_SHOW.replace("%0","<em>");b=b.replace("%1",c.broadcasterName+"'s");b=b.replace("%2","</em>");$j("#showCost .valueSpan").text(c.cost+nstiplang.tokens);$j("#rateNSDivTxt").html(b);break;}$j("#showDuration .valueSpan").text(Utils.secondsToTime(c.duration).inline());if(Cam4User.useResponsiveLayout){$j("#NSViewerOverlay").fadeIn();$j("#NSViewerOverlay").css("top","-117px");}else{$j("#NSViewerOverlay").show();$j("#NSViewerOverlay").css("top","-107px");}var a=Math.round(c.cost/100)*10;if(a<20){a=20;}$j("#tipAmmoRec").attr("value",a+"");$(window).trigger("resize");return 0;},hideReceipt:function(){$j("#NSViewerOverlay").hide();},chatWidthChanged:function(){NewShow.displayProperties.chatWidth=number;if(NewShow.displayProperties.chatWidth>400){NewShow.displayProperties.chatWidth=400;}NewShow.refreshStyle();},showBuyTokens:function(){NewShow.popup("http://www.cam4.com/checkout/tokens",650,500,CHECK_TOKENS);return 0;},onNewShowStateChanged:function(a){console.log("-0--------------> receives "+a);switch(a){case NewShowState.requestingCam2Cam:NewShowReceiver.showTippingActions();NewShow.visibleTippingBar(true);NewShow.requestingPrivateShow();NewShowReceiver.setMiddleButtonText('<button onclick="NewShowSender.cancelCam2CamRequest();" class="joinGroupB" id="requestPrivateShow">'+CANCEL_CAM2CAM_REQUEST+"</button>");break;case NewShowState.inCam2Cam:NewShowReceiver.showTippingActions();NewShow.visibleTippingBar(true);NewShow.inPrivateShow();NewShowReceiver.setMiddleButtonText('<button onclick="NewShowSender.stopCam2Cam();" class="joinGroupB" id="requestPrivateShow">'+END_CAM2CAM+"</button>");GoogleTrackNewShow.startPrivateShowWithCam2Cam();if(Cam4User.hasCam2CamEnabled()){NewShowReceiver.onCam2CamUpdate(NewShowState.cam2cam.inCam2Cam);}break;case NewShowState.notAvailable:NewShowReceiver.showTippingActions();NewShow.visibleTippingBar(true);NewShow.showMain(false);break;case NewShowState.guest:NewShowReceiver.showTippingActions();NewShow.visibleTippingBar(true);NewShow.viewerIsGuest();break;case NewShowState.noPrivateShow:NewShowReceiver.showTippingActions();NewShow.visibleTippingBar(true);NewShow.noPrivateShowEnabled();break;case NewShowState.notRequestingPrivateShow:NewShowReceiver.showTippingActions();NewShow.notRequestingPrivateShow();NewShow.visibleTippingBar(true);if(Cam4User.hasCam2CamEnabled()){NewShowReceiver.onCam2CamUpdate(NewShowState.cam2cam.disabled);}break;case NewShowState.requestingPrivateShow:NewShowReceiver.showTippingActions();NewShow.visibleTippingBar(true);NewShow.requestingPrivateShow();break;case NewShowState.inPrivateShow:NewShowReceiver.showTippingActions();NewShow.visibleTippingBar(true);NewShow.inPrivateShow();GoogleTrackNewShow.startPrivateShow();break;case NewShowState.accesDenied:NewShowReceiver.showTippingActions();NewShow.visibleTippingBar(true);NewShow.accessDenied();break;case NewShowState.requestingSpy:NewShowReceiver.showTippingActions();NewShow.visibleTippingBar(true);NewShow.requestingSpy();break;case NewShowState.inSpy:NewShowReceiver.showTippingActions();NewShow.visibleTippingBar(true);NewShow.inSpy();break;case NewShowState.requestExpired:NewShowReceiver.showTippingActions();NewShow.visibleTippingBar(true);NewShow.requestExpired();break;case NewShowState.pendingPrivateShow:NewShowReceiver.showTippingActions();NewShow.pendingPrivateShow();break;case NewShowState.requestGroupShow:NewShowReceiver.showTippingActions();NewShow.visibleTippingBar(false);NewShow.viewerRequestGroupShow();break;case NewShowState.goalReached:NewShowReceiver.showTippingActions();NewShow.goalReached();break;case NewShowState.goalReachedTicketPurchased:NewShowReceiver.showTippingActions();NewShow.goalReachedTicketPurchased();break;case NewShowState.sellingTicketsTicketPurchased:NewShowReceiver.showTippingActions();NewShow.viewerSellingTicketsTicketPurchased();break;case NewShowState.inGroupShow:NewShowReceiver.showTippingActions();NewShow.visibleTippingBar(false);NewShow.viewerInGroupShow();if(CURRENT_STATE===NewShowState.groupShowPaused){ServiceTipViewer.clearSession();}break;case NewShowState.accessDeniedGS:NewShowReceiver.showTippingActions();NewShow.accessDeniedGS();if(ncTip instanceof TipWatcherNS){NewShow.updateTippingData(NewShow.status.info);}break;case NewShowState.guestInGroupShow:NewShowReceiver.showTippingActions();NewShow.viewerGuestInGroupShow();break;case NewShowState.inBonusTime:NewShowReceiver.showTippingActions();NewShow.viewerInBonusTime();break;case NewShowState.accessDeniedInBonusTime:NewShowReceiver.showTippingActions();NewShow.viewerAccessDeniedBT();break;case NewShowState.groupShowPaused:NewShowReceiver.hideTippingActions();break;}CURRENT_STATE=a;console.log("----->  out with current state=== "+CURRENT_STATE);NewShow.refreshStyle();return CURRENT_STATE;},setViewerGroupShowInfo:function(a){if(a){NewShow.status.info=jQuery.parseJSON(a);if(NewShow.status.info.bonusTime>0){var b=Math.floor(NewShow.status.info.bonusTime/60);NewShow.status.xtraData=(" +("+b+")"+nstiplang.minutes);}else{NewShow.status.xtraData="";}console.log("flash calls ",NewShow.status.info);}NewShow.updateTippingData(NewShow.status.info);},setBuyTicketButton:function(a){if(a){NewShowReceiver.setMiddleButtonText('<button onclick="NewShow.buyTicket();"  class="joinGroupB" id="requestPrivateShow">'+BUY_TICKET_GS+"</button>");}else{NewShowReceiver.setMiddleButtonText('<button class="joinGroupB NSMainButtonDisabled" id="requestPrivateShow">'+BUY_TICKET_GS+"</button>");}return a;},ticketPurchased:function(){NewShow.showMain(true);NewShow.visibleTippingBar(false);NewShowReceiver.setMiddleButtonText('<button class="joinGroupB NSMainButtonDisabledSuccess" id="requestPrivateShow">'+TICKET_PURCHASED+"</button>");console.log("TICKET PURCHASED FINISHED");return 0;},showMain:function(a){NewShow.showMain(a);},initCountDown:function(a,b){console.log("init countdown with "+a);switch(b){case"startIn":NewShow.status.timeInfo=SHOW_STARTS_IN;break;case"endIn":NewShow.status.timeInfo=SHOW_ENDS_IN;break;case"bonusTime":NewShow.status.timeInfo=BONUS_TIME;break;}NewShow.initCountDown(a);},stopCountDown:function(a){NewShow.stopCountDown(a);},hideTippingActions:function(){$j("#sendTipButtonViewer").css("visibility","hidden");$j("#i_tipAmmo").css("visibility","hidden");$j("#staticTipMessage").css("visibility","hidden");$j("#mainPSButton").css("visibility","hidden");$j(".grd-orange2").css("visibility","hidden");$j("#NSTimeLeftVr").css("visibility","hidden");},showTippingActions:function(){$j("#NSTimeLeftVr").css("visibility","visible");$j("#mainPSButton").css("visibility","visible");$j("#i_tipAmmo").css("visibility","visible");$j("#sendTipButtonViewer").css("visibility","visible");$j("#staticTipMessage").css("visibility","visible");$j(".grd-orange2").css("visibility","visible");}};var NewShowSender={requestCam2Cam:function(){try{flashObj.requestPrivateShowCam2Cam();}catch(a){}},stopCam2Cam:function(){try{flashObj.stopCam2Cam();}catch(a){console.log(a,"player dow not support yet this method");}},cancelCam2CamRequest:function(){try{flashObj.cancelCam2CamRequest();}catch(a){console.log("flashObj.cancelCam2CamRequest NOT SUPPORTED");}},getSwfObject:function(){if(navigator.appName.indexOf("Microsoft")!=-1){flashObj=window.Cam4VChat;clearTimeout(NewShow.displayProperties.timeoutId);return flashObj;}else{flashObj=document.Cam4VChat;clearTimeout(NewShow.displayProperties.timeoutId);return flashObj;}if(typeof flashObj=="undefined"){console.log("is undefined");NewShow.displayProperties.timeoutId=setTimeout(NewShow.getSwf,500);}return flashObj;},enterMyPrivateLiveShow:function(){try{flashObj.requestPrivateShow();GoogleTrackNewShow.requestPrivateShow();return true;}catch(a){return false;}},cancelPrivateShowRequest:function(){try{flashObj.cancelPrivateShowRequest();return true;}catch(a){return false;}},requestSpyMode:function(){try{flashObj.requestSpyMode();return true;}catch(a){return false;}},cancelSpyRequest:function(){flashObj.cancelSpyRequest();},stopSpyMode:function(){try{flashObj.stopSpyMode();return true;}catch(a){return false;}},stopPrivateShow:function(){flashObj.stopPrivateShow();GoogleTrackNewShow.stopPrivateShow();}};TipExt={sendTipFromReceipt:function(){var a=$j("#tipAmmoRec").val();a=parseInt(a);ServiceTipViewer.sendTip(a);},sendTip:function(a){ServiceTipViewer.sendTip(a);}};var NewShow={fixLang:function(){try{$j("#introTxttest").textfill({maxFontPixels:12});$j(".requestPsAutosize").textfill({maxFontPixels:12});}catch(a){}switch(Cam4User.lang){case"nl":if(NewShowState.currentCam2CamState===NewShowState.cam2cam.requestSended){$j("#Cam2CamButton").css("font-size","10px");}else{$j("#Cam2CamButton").css("font-size","12px");}break;case"pt":$j("#Cam2CamButton").css("font-size","11px");break;case"fr":case"de":case"da":if(!NewShow.frLangSetted){var c=$j("#introTxttest .sendatip").html().split(" ");var b=c[0]+"<br />"+c[1];if(Cam4User.lang!=="da"){b+=" "+c[2];}$j("#introTxttest .sendatip").html(b);$j("#introTxttest .sendatip").css("line-height","10px");$j("#introTxttest .sendatip").css("font-size","11px");NewShow.frLangSetted=true;}break;}return Cam4User.lang;},displayProperties:{rateSetted:false,lastRateSelected:0,lastAction:{},nsFlag:true,chatWidth:338,totalWidth:880,timeoutId:0},isInGroupShow:false,visibleTippingBar:function(a){if(a){$j("#tippingDiv").show();$j("#newTipAreaMain").hide();TipExt.sendTip=function(b){ServiceTipViewer.sendTip(b);};ncTip=new TipWatcher();if(typeof tipping!="undefined"){tipping.refreshListeners();}}else{ncTip=new TipWatcherNS();if(typeof tipping!="undefined"){tipping.refreshListeners();}$j("#tippingDiv").hide();$j("#newTipAreaMain").show();TipExt.sendTip=function(b){try{flashObj.groupShowSendTip(b);}catch(c){console.log(c);console.log("send tip failed in ns");}};}},status:{vrTimeLeft:0,timerId:0,timeInfo:SHOW_STARTS_IN,info:{showDescription:"",ticketPrice:0,showLength:0,tokensGoal:0,timeLeft:0,tokensProgress:90,allowed:false,tokensSpent:0},xtraData:""},viewerRequestGroupShow:function(){NewShow.visibleTippingBar(false);NewShowReceiver.setBuyTicketButton(true);NewShow.status.timeInfo=SHOW_STARTS_IN;NewShow.isInGroupShow=false;NewShowReceiver.setViewerGroupShowInfo();NewShow.showMain(true);ncTip.setViewerOnline();ncTip.loadLang();},accessDeniedGS:function(){NewShowReceiver.setBuyTicketButton(true);NewShow.status.timeInfo=SHOW_ENDS_IN;NewShow.showMain(true);NewShow.updateTippingData(NewShow.status.info);NewShow.visibleTippingBar(false);},viewerInGroupShow:function(){NewShow.showMain(true);NewShow.visibleTippingBar(false);NewShow.visibleTippingButtons(true);NewShowReceiver.setMiddleButtonText('<button class="joinGroupB NSMainButtonDisabledSuccess" id="requestPrivateShow"> '+TICKET_PURCHASED+" </button>");NewShow.status.timeInfo=SHOW_ENDS_IN;NewShow.isInGroupShow=true;NewShowReceiver.setViewerGroupShowInfo();},refundTicket:function(){NewShow.visibleTippingBar(false);console.log("FLASH CALLS REFUND TICKET");NewShow.isInGroupShow=false;},viewerSellingTicketsTicketPurchased:function(){NewShow.showMain(true);NewShow.visibleTippingBar(false);NewShowReceiver.setMiddleButtonTextl('<button class="joinGroupB NSMainButtonDisabledSuccess" id="requestPrivateShow"> '+TICKET_PURCHASED+" </button>");},buyTicket:function(){console.log("FLASH CALLS BUY TICKET BASIC");NewShowReceiver.setBuyTicketButton(false);try{flashObj.groupShowBuyTicket();}catch(a){console.log(a);console.log("buyTicketFailed");}},initCountDown:function(e){console.log("init countdown called with"+e);e=parseInt(e);if(e>-1){$j("#NSTimeLeftVr").show();var d=Utils.secondsToTime(e);var c=(CURRENT_STATE===NewShowState.accessDeniedInBonusTime||CURRENT_STATE===NewShowState.inBonusTime)?" ":NewShow.status.xtraData;var a=d.h+":"+d.m+":"+d.s+c;var b=NewShow.status.timeInfo+a;$j("#NSTimeLeftVr").text(b);ncTip.toogleBlackBar(false);ncTip.setRightContentData(nstiplang.costPerTicket+":",nstiplang.showLength+":","",NewShow.status.info.ticketPrice,NewShow.status.info.showLength/60,b,nstiplang.tokens,nstiplang.minutes,"");NewShow.status.timerId=setTimeout(function(){NewShow.initCountDown(e-1);},1000);}else{$j("#NSTimeLeftVr").text(" ");NewShow.status.timerId=setTimeout(function(){console.log("timp expirat");NewShow.stopCountDown(true);},1000);}},stopCountDown:function(a){console.log("stop countdown, hidden = "+a);if(a){$j("#NSTimeLeftVr").hide();ncTip.toogleBlackBar(false);}else{$j("#NSTimeLeftVr").show();ncTip.toogleBlackBar(false);}clearTimeout(NewShow.status.timerId);},goalReached:function(){NewShowReceiver.setBuyTicketButton(true);NewShow.visibleTippingBar(false);NewShow.showMain(true);},goalReachedTicketPurchased:function(){NewShowReceiver.setMiddleButtonText('<button class="joinGroupB NSMainButtonDisabledSuccess" id="requestPrivateShow">'+TICKET_PURCHASED+"</button>");NewShow.visibleTippingBar(false);NewShow.showMain(true);},buyTicketAmmo:function(b){try{flashObj.groupShowSendTip(b);}catch(a){console.log(a);}},leaveGroupShow:function(){console.log("FLASH CALLS leaveGroupShow ????? ");},updateTippingData:function(a){var c=parseInt(a.showLength/60)%60;var b=parseInt(a.timeLeft/60)%60;ncTip.updateGoalBarData(a.tokensProgress,a.tokensGoal);ncTip.confirmViewerStatusMessage(a.showDescription);ncTip.confirmFirstInfo(parseInt(a.ticketPrice));ncTip.confirmSecondInfo(parseInt(c));$j("#infoPre1").html(nstiplang.costPerTicket+":");$j("#infoPre2").html(nstiplang.showLength+":");},viewerGuestInGroupShow:function(){NewShowReceiver.setMiddleButtonText('<button onclick="NewShow.openPaygate();"  class="joinGroupB" id="requestPrivateShow">'+BUY_TICKET_GS+"</button>");NewShow.showMain(true);NewShow.visibleTippingBar(false);NewShow.updateTippingData(NewShow.status.info);return 0;},viewerInBonusTime:function(){NewShow.showMain(true);NewShow.visibleTippingBar(false);},viewerAccessDeniedBT:function(){NewShow.visibleTippingBar(false);NewShow.showMain(true);NewShowReceiver.setMiddleButtonText('<button class="joinGroupB NSMainButtonDisabled" id="requestPrivateShow">'+PERFORMER_IN_BONUS_TIME+"</button>");},openPaygate:function(){window.location.href="/paygate";return 0;},viewerIsGuest:function(){NewShowReceiver.setMiddleButtonText('<span id="noLinkToRun" style="width: auto;"> <a id="loginToPs" class="registerModal nopop" style="width: auto; text-shadow: 0 -1px 0 #000000; border:none; font-size:10px; padding:0px; margin:0px; text-transform: none " href="/gold?ct=wor&contextual=browse-'+Cam4User.contextualGender+'" target="_blank">'+USER_NOT_LOGGED+"</a></span>");$j(".timestatus").hide();NewShow.visibleTippingButtons(true);NewShow.displayProperties.nsFlag=false;NewShow.showMain(ACCESS_ZERO,NewShow.displayProperties.nsFlag);$j("#privateshowBanner").hide();},noPrivateShowEnabled:function(){NewShowReceiver.setMiddleButtonText('<span id="noLinkToRun">'+UNAVAILABLE_FOR_PS+"</span>");$j(".timestatus").hide();NewShow.showMain(false);},notRequestingPrivateShow:function(){NewShowReceiver.setMiddleButtonText('<button onclick="NewShowSender.enterMyPrivateLiveShow();" class="joinGroupB" id="requestPrivateShow">'+REQ_PS+"</button>");$j(".timestatus").hide();NewShow.showMain(true);},requestingPrivateShow:function(){NewShowReceiver.setMiddleButtonText('<button onclick="NewShowSender.cancelPrivateShowRequest()" class="joinGroupB" id="requestPrivateShow">'+CANCEL_PS_REQ+"</button>");$j(".timestatus").hide();NewShow.showMain(true);},inPrivateShow:function(){NewShowReceiver.setMiddleButtonText('<button onclick="NewShowSender.stopPrivateShow()" class="joinGroupB" id="requestPrivateShow">'+CANCEL_PS+"</button>");$j(".timestatus").show();NewShow.showMain(true);},accessDenied:function(){if(Cam4User.isSubscribedToFanClub()){NewShowReceiver.setMiddleButtonText('<button onclick="NewShowSender.requestSpyMode();"  class="joinGroupB" id="requestPrivateShow">'+REQ_FREE_SPY+"</button>");}else{NewShowReceiver.setMiddleButtonText('<button onclick="NewShowSender.requestSpyMode();"  class="joinGroupB" id="requestPrivateShow">'+REQ_SPY+"</button>");}$j(".timestatus").hide();NewShow.showMain(true);},requestingSpy:function(){NewShowReceiver.setMiddleButtonText('<button onclick="NewShowSender.cancelSpyRequest();"  class="joinGroupB" id="requestPrivateShow">'+CANCEL_SPY_REQ+"</button>");$j(".timestatus").hide();NewShow.showMain(true);},inSpy:function(){NewShowReceiver.setMiddleButtonText('<button onclick="NewShowSender.stopSpyMode();"  class="joinGroupB" id="requestPrivateShow">'+CANCEL_SPY+"</button>");$j(".timestatus").show();NewShow.showMain(true);},requestExpired:function(){NewShowReceiver.setMiddleButtonText('<a href="#broadcastingApp" onclick="NewShowSender.enterMyPrivateLiveShow();" class="joinGroupB"  id="requestPrivateShow">'+REQ_EXPIRED+"</a>");$j(".timestatus").html('<span style="font-weight: normal; color: #fff; font-size:16px">'+REQ_EXPIRED_REASON+"</span>");$j(".timestatus").show();},pendingPrivateShow:function(){NewShowReceiver.setMiddleButtonText("<a href='javascript:void(0)' onclick='NewShowSender.cancelPrivateShowRequest();' class='joinGroupB' id='requestPrivateShow'> pending private show </a>");$j(".timestatus").hide();},visibleTippingButtons:function(a){if(a){$j("#staticTipMessage").css("visibility","visible");$j("#staticTipMessage").css("display","block");$j(".grd-orange2").css("visibility","visible");$j(".grd-orange2").css("display","block");}else{$j("#staticTipMessage").css("visibility","hidden");$j("#staticTipMessage").css("display","none");$j(".grd-orange2").css("visibility","hidden");$j(".grd-orange2").css("display","none");}},commitFavorite:function(c,d,b){if(d==="addFavorite"){ffUpdate.update=function(){$j("#addPsFavoriteBtn").text(REMOVE_FRIEND);document.getElementById("addPsFavoriteBtn").setAttribute("onclick","NewShow.commitFavorite(event, 'removeFavorite', '"+b+"', false);");$j("#heartImg").attr("src",CDN_LOCATION+"/images/fav_rem.png");};addFriendFavorite("addFavorite",b);}else{ffUpdate.update=function(){$j("#addPsFavoriteBtn").text(ADD_FRIEND);document.getElementById("addPsFavoriteBtn").setAttribute("onclick","NewShow.commitFavorite(event, 'addFavorite', '"+b+"', false);");$j("#heartImg").attr("src",CDN_LOCATION+"/images/fav_add.png");};try{addFriendFavorite("removeFavorite",b,false);}catch(a){ffUpdate.update();}}c.preventDefault();c.stopPropagation();},sendPrivateMessageFromReceipt:function(c,a){var b=document.getElementById("privateFromReceipt").value;$j.post("/mail",{username:c,subject:"Message from private show client "+a,message:b,success:function(){$j("#pm.miscFeat").fadeOut();$j("#privateFromReceipt").fadeOut();$j("#receiptFeatWrap .featList input[type=button]").fadeOut();}});},togglePrivateMessageForm:function(){$j("#privateFromReceipt").slideToggle();},showMain:function(b,a){try{if(Cam4User.isModerator){b=true;}}catch(c){}if(b){$j("#options2").show();$j("#NewShowMainBar").show();$j("#innerTubeViewer").show();NewShow.fixLang();}else{$j("#options2").hide();$j("#NewShowMainBar").hide();$j("#innerTubeViewer").hide();}NewShow.refreshStyle(a);},refreshStyle:function(b){$j("#NSBar").css("filter","none");NewShow.displayProperties.totalWidth=$j("#options2").width()||$j("#NewShowMainBar").width();var a=$j("#staticTipMessage").width()+$j("#tipBox1").width()+$j("#tipBox2").width()+$j("#tipBox3").width()+$j("#tipBox4").width();var c=NewShow.displayProperties.totalWidth-a-NewShow.displayProperties.chatWidth;$j("#subChatBar").width(NewShow.displayProperties.chatWidth);$j("#subChatBar").css("border","none");if(b){$j("#mainPSButton a").width(c-26);}var d=$j("#requestPrivateShow").text();if(d.length>40){$j("#requestPrivateShow").css("line-height","12px");}else{$j("#requestPrivateShow").css("line-height","22px");}return true;},popup:function(a,f,g,i){var b=f;var j=g;var c=(screen.width-b)/2;var h=(screen.height-j)/2;var d="width="+b+", height="+j;d+=", top="+h+", left="+c;d+=", directories=no";d+=", location=no";d+=", menubar=no";d+=", resizable=no";d+=", scrollbars=no";d+=", status=no";d+=", toolbar=no";var e=window.open(a,i,d);if(window.focus){e.focus();}return e;},LeadingZero:function(a){return(a<10)?"0"+a:a;}};JsReceiver.onCompleteProfileInfo=function(){Cam4Event.removeEventListener("viewerProfileCompleted");Cam4Event.addEventListener("viewerProfileCompleted",function(b){Cam4User.needsMainProfileInfoCompletion=function(){return false;};try{flashObj.onNotifyProfileInfoCompleted();}catch(a){console.log("flashObj does not support this method yet");}});CompleteProfile.showOverlay();};var MasterTest={sec:0,simulateInterval:function(){MasterTest.sec++;NewShowReceiver.updateBillingPrivateShow(MasterTest.sec);},rPSSample:'{"duration":"21", "cost":"31", "broadcasterName": "goguTesting"}',rCSSample:'{"duration":"22", "cost":"32", "broadcasterName": "goguTesting", "timeInCam2Cam": "4000"}',rSSSample:'{"duration":"23", "cost":"33", "broadcasterName": "goguTesting"}',rGSSample:'{"duration":"24", "broadcasterName": "goguTesting", "ticketCost":"34", "tipsSent":"90"}',testReceiptPS:function(){NewShowReceiver.showReceipt(MasterTest.rPSSample,NewShowReceiver.receiptMode.inPS);},testReceiptSS:function(){NewShowReceiver.showReceipt(MasterTest.rSSSample,NewShowReceiver.receiptMode.inSS);},testReceiptGS:function(){NewShowReceiver.showReceipt(MasterTest.rGSSample,NewShowReceiver.receiptMode.inGS);},testReceiptCS:function(){NewShowReceiver.showReceipt(MasterTest.rCSSample,NewShowReceiver.receiptMode.inPS);}};$j(document).ready(function(){try{NewShow.displayProperties.lastAction=ffUpdate.update;}catch(a){setTimeout(function(){NewShow.displayProperties.lastAction=ffUpdate.update;},1000);}NewShow.updateTippingData(NewShow.status.info);NewShow.refreshStyle();$j("#sendPrivateForm").hide();NewShowSender.getSwfObject();ncTip.init();});NewShowSender.getSwfObject();var NSClient=NewShowReceiver;NSClient.setNewShowState=NewShowReceiver.onNewShowStateChanged;